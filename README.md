# Exploit Server
Similar to Portswigger's exploit server for rapid experimentation.
More limited in that malformed headers (headers starting with spaces) are removed by gunicorn and it is not as easy to modify the return type (e.g. 301/302 redirect).

Out of bands detection can be done by setting up another tool such as [https://interact.sh/](https://interact.sh/) as logs are not kept here.

## Known limitations
- Protocol gets overwritten by nginx in prod, cannot change HTTP/1.1
- Cannot return headers with a space

# Configure host

```bash
# install dependencies
sudo apt update && sudo apt upgrade -y
sudo apt install -y docker docker-compose

# get code
git clone https://github.com/alecmaly/exploit-server.git /opt/exploit_server

# cd into directory
cd /opt/exploit_server
```

## Set config variables
**domain**
Update domain (do6.us)
`services\nginx\user_conf.d\default.conf`


**conf file**
Update CERTBOT_EMAIL with custom domain
`services\nginx\nginx-certbot.env`

**set password**
login username is admin
`.env`
```
PASSWORD="password"
```

## clone repository to server
```bash
git clone https://github.com/alecmaly/exploit-server.git
```

## Clear all containers and images
```bash
docker rm $(docker ps -a -f status=exited -q)
docker rmi $(docker images -a -q)
```

# Nginx

This is done automatically. Manual command to enter nginx container is listed below.

[Install ssl cert](https://certbot.eff.org/instructions?ws=nginx&os=ubuntufocal)

## Install ssl certificate
```bash
docker exec -it $(docker ps | grep nginx | cut -d' ' -f1) bash
certbot --nginx -d do6.com -d www.do6.us 
```

# Testing
```bash
cd ./services/web/

# flask
python run.py run

# gunicorn
gunicorn -w 2 -b :80 run:app 
gunicorn -w 2 -b :443 --certfile /etc/letsencrypt/live/do6.us/fullchain.pem --keyfile  /etc/letsencrypt/live/do6.us/privkey.pem run:app 
```

